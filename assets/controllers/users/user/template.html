<div class="row">
    <div class="col-md-6">

        <div class="user-photo">
            <img ng-if="ctrl.user.photo" ng-src="{{ctrl.user.photo.src}}" alt="" />
            <img ng-if="!ctrl.user.photo && ctrl.user.gravatar_hash" ng-src="https://www.gravatar.com/avatar/{{ctrl.user.gravatar_hash}}?s=270&amp;d=https://www.autowp.ru/_.gif&r=g" alt="" />
        </div>

        <p>
            {{'users/user/known-as:'|translate}}
            <strong>«{{ctrl.user.name}}»</strong>
        </p>
        <div style="color:#666666;margin-left:40px;cursor:help" title="{{rename.date | date:'medium'}}" ng-repeat="rename in ctrl.user.renames">
            {{'users/user/before-known-as:'|translate}}
            <strong style="color:#666666">«{{rename.old_name}}»</strong>
        </div>

        <p>
            {{'users/user/type:'|translate}} 
            <strong ng-if="ctrl.user.is_moder" translate>users/user/type/moderator</strong>
            <strong ng-if="!ctrl.user.is_moder" translate>users/user/type/visitor</strong>
        </p>

        <p ng-if="ctrl.user.reg_date">
            {{'users/user/registration-date'|translate}}:
            <strong am-time-ago="ctrl.user.reg_date"></strong>
        </p>
        <p>
            {{'users/user/last-visited'|translate}}:
            <strong am-time-ago="ctrl.user.last_online"></strong>
        </p>

        <p translate="ng/moder/database-id-n" translate-values="{id: ctrl.user.id}"></p>

        <p ng-if="user && !ctrl.isMe">
            <i class="fa fa-reply"></i>
            <a href="#" ng-click="ctrl.openMessageForm()" translate>users/user/send-personal-message</a>
        </p>

        <p ng-repeat="account in ctrl.user.accounts">
            <i class="{{account.icon}} fa-fw"></i>
            <a ng-href="{{account.link}}" ng-if="account.link" ng-bind="account.name"></a>
            <span ng-if="!account.link" ng-bind="account.name"></span>
        </p>

        <h2 translate>users/user/recent-activity</h2>
        <div class="well">
            <div ng-if="ctrl.user.pictures_added > 0">
                <p>{{'users/user/upload-pictures:'|translate}} <strong ng-bind="ctrl.user.pictures_added"></strong></p>
                <p ng-if="ctrl.user.pictures_accepted_count < ctrl.user.pictures_added">
                    {{'users/user/pictures-left-on-site:'|translate}} 
                    <strong ng-bind="ctrl.user.pictures_accepted_count"></strong>
                </p>

                <p><a ng-href="/users/{{ctrl.user.identity ? ctrl.user.identity : 'user' + ctrl.user.id}}/pictures" translate>users/user/uploaded-pictures</a></p>
            </div>
            <p translate ng-if="ctrl.user.pictures_added <= 0">users/user/not-upload-pictures</p>

            <p ng-if="isModer"><a ui-sref="log({user_id: ctrl.user.id})" translate>users/user/log</a></p>
        </div>


        <div ng-if="ctrl.pictures.length">
            <h2 translate>users/user/recent-uploads</h2>
            <div class="well">
                <ul>
                    <li ng-repeat="picture in ctrl.pictures">
                        <a ng-href="{{picture.url}}" class="picture-hover-preview" ng-bind-html="picture.name_html"></a>
                    </li>
                </ul>
            </div>
        </div>

        <div ng-if="ctrl.comments.length > 0">
            <h2>
                {{'users/user/recent-comments'|translate}}
                <small><a ui-sref="users-user-comments({identity: ctrl.user.identity ? ctrl.user.identity : 'user' + ctrl.user.id})" translate>all-link</a></small>
            </h2>
            <div class="well">
                <ul class="comments">
                    <li ng-repeat="comment in ctrl.comments">
                        <a ng-href="{{comment.url}}" ng-bind="comment.preview"></a>
                    </li>
                    <li>&#xa0;...</li>
                </ul>
            </div>
        </div>

    </div>
    <div class="col-md-6">

        <div class="well" ng-if="ctrl.canBeInContacts">
            <button type="submit" class="btn btn-lg btn-contact" ng-class="{'in-contacts': ctrl.inContacts}" ng-click="ctrl.toggleInContacts()">
                <span class="not-in-contacts">
                    <span class="fa fa-plus-circle"></span>
                    {{'user/add-to-contacts'|translate}}
                </span>
                <span class="in-contacts">
                    <span class="fa fa-minus-circle"></span>
                    {{'user/remove-from-contacts'|translate}}
                </span>
            </button>
        </div>

        <div ng-if="ctrl.canViewIp">
            <h2 translate>users/for-moderators</h2>
            <div class="well">
                <p ng-if="ctrl.canBan && ctrl.user.photo">
                    <button class="btn btn-warning btn-block btn-delete-photo" ng-click="ctrl.deletePhoto()" translate>users/for-moderators/remove-photo</button>
                </p>

                <p ng-if="ctrl.canDeleteUser">
                    <button class="btn btn-danger btn-block btn-delete-user" ng-click="ctrl.deleteUser()" translate>users/for-moderators/remove-user</button>
                </p>

                <p>
                    {{'users/for-moderators/last-visit-from-ip'|translate}}
                    {{ctrl.user.last_ip}}
                </p>

                <div ng-if="ctrl.ip.blacklist">
                    <p>
                        {{'ban/that-address-is-banned'|translate}}
                        <autowp-user ng-if="ctrl.ip.blacklist.user" user="ctrl.ip.blacklist.user"></autowp-user>
                        <span ng-if="ctrl.ip.blacklist.up_to">
                            {{'ban/until'|translate}}
                            {{ctrl.ip.blacklist.up_to|date:'medium'}}
                            <span ng-if="ctrl.ip.blacklist.reason">
                                ({{ctrl.ip.blacklist.reason}})
                            </span>
                        </span>
                    </p>

                    <div style="margin:10px 0" ng-if="ctrl.canBan">
                        <button class="btn btn-success" translate ng-click="ctrl.removeFromBlacklist()">ban/unban</button>
                    </div>
                </div>

                <form class="form-vertical" ng-if="! ctrl.ip.blacklist && ctrl.ip.rights.add_to_blacklist">
                    <div class="form-group">
                        <label translate>ban/period</label>
                        <select ng-model="ctrl.banPeriod" class="form-control" required>
                            <option ng-repeat="(value, name) in ctrl.banPeriods" ng-value="{{value}}">
                                {{name|translate}}
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label translate>ban/reason</label>
                        <input maxlength="50" class="form-control" ng-model="ctrl.banReason" />
                    </div>
                    <button class="btn btn-danger" ng-click="ctrl.addToBlacklist(ctrl.ip.address)" translate>ban/ban</button>
                </form>

            </div>
        </div>

    </div>
</div>