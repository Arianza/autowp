<p ng-if="ctrl.parent">
    {{'moder/vehicle/add/as-submodel'|translate}}
    <span ng-bind-html="ctrl.parent.name_html"></span>
</p>

<span ng-show="ctrl.loading > 0">
    <i class="fa fa-spinner fa-spin fa-fw"></i>
</span>

<form method="post" class="form-horizontal" ng-submit="ctrl.submit()"><fieldset>
    <div class="form-group" ng-class="{'has-error':ctrl.invalidParams.name}">
        <label class="col-md-2 control-label" translate>moder/vehicle/name</label>
        <div class="col-md-10">
            <input type="text" name="name" ng-model="ctrl.item.name" class="form-control" maxlength="{{ctrl.name_maxlength}}" />
            <p ng-repeat="message in ctrl.invalidParams.name" ng-bind="message" class="help-block"></p>
        </div>
    </div>
    <div class="form-group" ng-class="{'has-error':ctrl.invalidParams.full_name}" ng-if="ctrl.item_type_id == 5">
        <label class="col-md-2 control-label" translate>moder/brands/meta-data/full-name</label>
        <div class="col-md-10">
            <input type="text" name="full_name" ng-model="ctrl.item.full_name" class="form-control" maxlength="{{ctrl.full_name_maxlength}}" />
            <p ng-repeat="message in ctrl.invalidParams.full_name" ng-bind="message" class="help-block"></p>
        </div>
    </div>
    <div class="form-group" ng-class="{'has-error':ctrl.invalidParams.catname}" ng-if="ctrl.item_type_id == 5 || ctrl.item_type_id == 3">
        <label class="col-md-2 control-label">Catname</label>
        <div class="col-md-10">
            <input type="text" name="catname" ng-model="ctrl.item.catname" class="form-control" />
            <p ng-repeat="message in ctrl.invalidParams.catname" ng-bind="message" class="help-block"></p>
        </div>
    </div>
    <div class="form-group" ng-class="{'has-error':ctrl.invalidParams.body}" ng-if="ctrl.item_type_id == 1 || ctrl.item_type_id == 2">
        <label class="col-md-2 control-label" translate>moder/vehicle/body</label>
        <div class="col-md-10">
            <input type="text" name="body" ng-model="ctrl.item.body" style="width: 30%" class="form-control" maxlength="{{ctrl.body_maxlength}}" />
            <p ng-repeat="message in ctrl.invalidParams.body" ng-bind="message" class="help-block"></p>
        </div>
    </div>
    <div class="form-group" ng-class="{'has-error':ctrl.invalidParams.spec_id}" ng-if="ctrl.item_type_id == 1 || ctrl.item_type_id == 2">
        <label class="col-md-2 control-label" translate>moder/vehicle/spec</label>
        <div class="col-md-10">
            <select name="spec_id" ng-model="ctrl.item.spec_id" style="width: 30%" class="form-control">
                <option value="inherited">inherited{{ctrl.parentSpec ? ' (' + ctrl.parentSpec.short_name + ')' : ''}}</option>
                <option value="">--</option>
                <option value="{{item.id}}" ng-repeat="item in ctrl.specOptions">{{'...'.repeat(item.deep)}}{{item.short_name}}</option>
            </select>
            <p ng-repeat="message in ctrl.invalidParams.spec_id" ng-bind="message" class="help-block"></p>
        </div>
    </div>
    <div class="form-group" ng-if="ctrl.item_type_id == 1 || ctrl.item_type_id == 4">
        <label class="col-md-2 control-label" translate>moder/vehicle/type</label>
        <div class="col-md-10">
            <tags-input ng-model="ctrl.item_vehicle_type" 
                placeholder="Add"
                replace-spaces-with-dashes="false"
                add-from-autocomplete-only="true"
                key-property="id"
                display-property="name"
                min-length="0"
                template="vehicle-type-tag-template">
                <auto-complete source="ctrl.loadVehicleTypes($query)" 
                     min-length="0"
                     load-on-empty="true"
                     load-on-focus="true"
                     debounce-delay="0"
                     max-results-to-show="30"
                     template="vehicle-type-list-template"></auto-complete>
            </tags-input>
        </div>
        <script type="text/ng-template" id="vehicle-type-tag-template">
            <div>{{data.name|translate}}</div>
        </script>
        <script type="text/ng-template" id="vehicle-type-list-template">
            <div>{{'...'.repeat(data.deep)}}{{data.name|translate}}</div>
        </script>
    </div>
    <div class="form-group" ng-class="{'has-error':ctrl.invalidParams.begin_model_year || ctrl.invalidParams.end_model_year}" ng-if="ctrl.item_type_id == 1 || ctrl.item_type_id == 2">
        <label class="col-md-2 control-label" translate>moder/vehicle/model-years</label>
        <div class="col-md-10">
            <fieldset class="form-inline">
                <input type="number" name="begin_model_year" ng-model="ctrl.item.begin_model_year" placeholder="{{'moder/vehicle/year/from'|translate}}" style="width: 10%" min="1800" max="{{ctrl.model_year_max}}" class="form-control" maxlength="4" />
                <input type="number" name="end_model_year" ng-model="ctrl.item.end_model_year" placeholder="{{'moder/vehicle/year/to'|translate}}" style="width: 10%" min="1800" max="{{ctrl.model_year_max}}" class="form-control" maxlength="4" />
            </fieldset>
            <p ng-repeat="message in ctrl.invalidParams.begin_model_year" ng-bind="message" class="help-block"></p>
            <p ng-repeat="message in ctrl.invalidParams.end_model_year" ng-bind="message" class="help-block"></p>
        </div>
    </div>
    <div class="form-group" ng-class="{'has-error':ctrl.invalidParams.begin_year||ctrl.invalidParams.begin_month}">
        <label class="col-md-2 control-label" translate>moder/vehicle/begin</label>
        <div class="col-md-10">
            <fieldset class="form-inline">
                <input type="number" name="begin_year" ng-model="ctrl.item.begin_year" placeholder="{{'moder/vehicle/year'|translate}}" style="width: 10%" min="1800" max="{{ctrl.year_max}}" class="form-control" maxlength="4" />
                <select name="begin_month" ng-model="ctrl.item.begin_month" title="{{'moder/vehicle/month'|translate}}" style="width: 20%" class="form-control">
                    <option value="">--</option>
                    <option value="{{month.value}}" ng-repeat="month in ctrl.monthOptions">{{month.name}}</option>
                </select>
            </fieldset>
            <p ng-repeat="message in ctrl.invalidParams.begin_year" ng-bind="message" class="help-block"></p>
            <p ng-repeat="message in ctrl.invalidParams.begin_month" ng-bind="message" class="help-block"></p>
        </div>
    </div>
    <div class="form-group" ng-class="{'has-error':ctrl.invalidParams.end_year||ctrl.invalidParams.end_month||ctrl.invalidParams.today}">
        <label class="col-md-2 control-label" translate>moder/vehicle/end</label>
        <div class="col-md-10">
            <fieldset class="form-inline">
                <input type="number" name="end_year" ng-model="ctrl.item.end_year" placeholder="{{'moder/vehicle/year'|translate}}" style="width: 10%" min="1800" max="{{ctrl.year_max}}" class="form-control" maxlength="4" />
                <select name="end_month" ng-model="ctrl.item.end_month" title="{{'moder/vehicle/month'|translate}}" style="width: 20%" class="form-control">
                    <option value="">--</option>
                    <option value="{{month.value}}" ng-repeat="month in ctrl.monthOptions">{{month.name}}</option>
                </select>
                <select name="today" ng-model="ctrl.item.today" style="width: 20%" title="{{'moder/vehicle/today'|translate}}" class="form-control">
                    <option value="">--</option>
                    <option value="0" translate>moder/vehicle/today/ended</option>
                    <option value="1" translate>moder/vehicle/today/continue</option>
                </select>
            </fieldset>
            <p ng-repeat="message in ctrl.invalidParams.end_year" ng-bind="message" class="help-block"></p>
            <p ng-repeat="message in ctrl.invalidParams.end_month" ng-bind="message" class="help-block"></p>
            <p ng-repeat="message in ctrl.invalidParams.today" ng-bind="message" class="help-block"></p>
        </div>
    </div>
    <div class="form-group" ng-class="{'has-error':ctrl.invalidParams.produced_count||ctrl.invalidParams.produced_exactly}" ng-if="ctrl.item_type_id == 1 || ctrl.item_type_id == 2">
        <label class="col-md-2 control-label" translate>moder/item/produced</label>
        <div class="col-md-10">
            <fieldset class="form-inline">
                <input type="number" name="produced_count" ng-model="ctrl.item.produced_count" style="width: 10%" min="0" max="100000000" class="form-control" title="{{'moder/item/produced/number'|translate}}" />
                <select name="produced_exactly" ng-model="ctrl.item.produced_exactly" style="width: 20%" class="form-control">
                    <option value="0" translate>moder/item/produced/about</option>
                    <option value="1" translate>moder/item/produced/exactly</option>
                </select>
            </fieldset>
            <p ng-repeat="message in ctrl.invalidParams.produced_count" ng-bind="message" class="help-block"></p>
            <p ng-repeat="message in ctrl.invalidParams.produced_exactly" ng-bind="message" class="help-block"></p>
        </div>
    </div>
    <div class="form-group" ng-if="ctrl.item_type_id == 1 || ctrl.item_type_id == 2">
        <label class="col-md-2 control-label" translate>moder/vehicle/concept</label>
        <div class="col-md-10">
            <select name="is_concept" ng-model="ctrl.item.is_concept" style="width: 20%" class="form-control">
                <option value="{{option.value}}" ng-repeat="option in ctrl.isConceptOptions">{{option.name|translate}}</option>
            </select>
        </div>
    </div>
    <div class="form-group" ng-if="ctrl.item_type_id == 1 || ctrl.item_type_id == 2">
        <div class="col-md-2">
        </div>
        <div class="col-md-10">
            <div class="checkbox">
                <label>
                    <input type="checkbox" name="is_group" value="1" ng-model="ctrl.item.is_group" />
                    {{'moder/vehicle/group'|translate}}
                </label>
            </div>
        </div>
    </div>
    <div class="form-group" ng-if="ctrl.item_type_id == 6 || ctrl.item_type_id == 7">
        <label class="col-md-2 control-label">Point</label>
        <div class="col-md-10">
            <fieldset class="form-inline">
                <input type="text" name="lat" ng-model="ctrl.item.lat" maxlength="20" size="20" style="width: 20%" placeholder="{{'latitude'|translate}}" class="form-control" ng-change="ctrl.coordsChanged()" />
                <input type="text" name="lng" ng-model="ctrl.item.lng" maxlength="20" size="20" style="width: 20%" placeholder="{{'longtitude'|translate}}" class="form-control" ng-change="ctrl.coordsChanged()" />
            </fieldset>
            <leaflet lf-center="ctrl.center" tiles="ctrl.tiles" markers="ctrl.markers" defaults="defaults" width="100%" height="300px"></leaflet>
        </div>
    </div>
    
    <div class="row">
        <div class="col-md-10 col-md-offset-2">
            <input type="submit" name="submit" class="btn btn-primary" value="Отправить">
        </div>
    </div>
</fieldset></form>